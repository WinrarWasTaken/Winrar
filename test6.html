<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Vanthrudnir Arms — PDA Terminal (Catalog)</title>
<style>
  :root{
    --pda-bg:#041018;
    --accent:#00eaff;
    --muted:#6fb7c6;
    --card:#041018;
    --width:380px;
  }

  html,body{height:100%;margin:0;background:
    radial-gradient(circle at 10% 10%, rgba(0,140,160,0.03), transparent 10%),
    linear-gradient(180deg,#02060a 0%, #030a0f 100%);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Courier New", monospace;color:var(--accent)}

  .screen-wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:28px}
  .pda{
    width:var(--width); max-width:92vw; border-radius:18px; padding:14px;
    background: linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.45));
    box-shadow: 0 30px 80px rgba(0,0,0,0.7), inset 0 1px 0 rgba(255,255,255,0.02);
    border: 1px solid rgba(0,255,255,0.06);
    position:relative; overflow:hidden; transform-origin:center;
  }
  .bezel{position:absolute;inset:0;border-radius:18px;pointer-events:none; box-shadow: inset 0 0 120px rgba(0,0,0,0.45); }

  /* status */
  .status{height:28px; display:flex;align-items:center;gap:10px;padding:6px 8px;color:var(--muted); font-size:12px;}
  .sigbar{display:flex;gap:6px;align-items:center}
  .dot{width:8px;height:8px;border-radius:50%;background:linear-gradient(180deg,var(--accent),#63e6ff);box-shadow:0 0 6px rgba(0,234,255,0.18)}
  .battery{width:36px;height:10px;border:1px solid rgba(255,255,255,0.06);border-radius:3px;display:inline-block;position:relative}
  .battery::after{content:'';position:absolute;right:-6px;top:2px;width:4px;height:6px;background:rgba(255,255,255,0.06);border-radius:1px}
  .bat-fill{height:100%;width:60%;background:linear-gradient(90deg,#99fbff,#00eaff);border-radius:2px}

  /* terminal shell */
  .terminal{ margin:8px; padding:10px; border-radius:10px; min-height:360px; box-sizing:border-box; border: 1px solid rgba(255,255,255,0.02); position:relative; overflow:hidden; background: linear-gradient(180deg, rgba(0,0,0,0.15), rgba(0,0,0,0.06)); }
  .top-row{display:flex;gap:8px;align-items:flex-start}
  .log{font-size:12px; line-height:1.35; color:var(--muted); white-space:pre-wrap; max-height:90px; overflow:auto; padding:6px; border-radius:6px; border-left:3px solid rgba(0,234,255,0.06); background: linear-gradient(180deg, rgba(0,10,14,0.25), rgba(0,10,14,0.06)); box-shadow: inset 0 1px 0 rgba(255,255,255,0.02); flex:1 }

  .brand{display:flex;flex-direction:column;align-items:center;margin:8px 0}
  .brand h1{margin:0;font-size:14px;letter-spacing:1px;color:#bffcff;text-shadow:0 0 8px rgba(0,234,255,0.06)}
  .brand h2{margin:2px 0 0;font-size:11px;color:var(--muted);font-weight:400}

  .divider{height:1px;background: linear-gradient(90deg, rgba(0,234,255,0.08), rgba(0,234,255,0.02));margin:8px 0;border-radius:2px}

  /* pages: only one visible at a time */
  .page { display:none; padding:6px 0; }
  .page.active { display:block; }

  .content{font-size:13px;color:#dff9ff;padding:6px 4px;line-height:1.45;max-height:220px;overflow:auto}
  ul { margin:6px 0 0 16px; padding:0;color:#dff9ff}
  li{margin-bottom:6px;font-size:12.6px}

  /* signature block */
  .sig-wrap{display:flex;flex-direction:column;gap:8px;padding:6px;margin-top:6px}
  input[type="text"]{ background:rgba(0,0,0,0.35); border:1px solid rgba(0,234,255,0.06); color:var(--accent); padding:10px;border-radius:6px; font-size:13px; outline:none; width:100%; }
  .btn{ background:linear-gradient(90deg,#00f2ff,#00a7ca); color:#00120f;border:none;padding:10px;border-radius:8px; font-weight:700;cursor:pointer; box-shadow:0 6px 18px rgba(0,234,255,0.08); text-transform:uppercase; letter-spacing:0.8px;}
  .btn.ghost{ background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.03)}
  .btn:active{transform:translateY(1px)}

  .ok-badge{display:inline-block;padding:6px 8px;border-radius:6px;background:linear-gradient(90deg,#79ffdd,#00caa6);color:#04211a;font-weight:700;margin-bottom:6px}
  .small-muted{font-size:12px;color:var(--muted)}

  /* catalog list */
  .catalog-list{display:flex;flex-direction:column;gap:8px;max-height:240px;overflow:auto;padding-right:6px}
  .gun-item{display:flex;gap:8px;align-items:center;padding:6px;border-radius:8px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));cursor:pointer;border:1px solid rgba(255,255,255,0.02)}
  .gun-item img{width:72px;height:50px;object-fit:cover;border-radius:6px}
  .gun-item .meta{font-size:13px}
  .hero{height:200px;background:rgba(0,0,0,0.25);border-radius:8px;display:flex;align-items:center;justify-content:center;overflow:hidden;border:1px solid rgba(255,255,255,0.02)}
  .hero img{max-width:100%;max-height:100%;object-fit:contain}

  .navs{display:flex;gap:8px;align-items:center;margin-top:8px}
  .export-area{padding:8px;background:rgba(0,0,0,0.06);border-radius:8px;max-height:220px;overflow:auto}

  /* responsive */
  @media (max-width:420px){
    :root{ --width:92vw; }
    .log{ max-height:72px }
    .hero{height:160px}
    .gun-item img{width:56px;height:40px}
  }
</style>
</head>
<body>
<div class="screen-wrap">
  <div class="pda">
    <div class="bezel"></div>

    <div class="status">
      <div class="sigbar">
        <div style="font-size:11px;color:var(--muted)">PDA v3.1</div>
        <div style="width:6px"></div>
        <div class="dot" title="link status"></div>
      </div>
      <div style="flex:1"></div>
      <div style="font-size:12px;color:var(--muted)" id="clock">--:--</div>
      <div style="width:10px"></div>
      <div class="battery" title="battery"><div class="bat-fill"></div></div>
    </div>

    <div class="terminal scanlines">
      <!-- top row with boot log and brand -->
      <div class="top-row" style="gap:12px">
        <div id="bootLog" class="log" aria-live="polite"></div>
      </div>

      <div class="brand" style="margin-top:8px">
        <h1>VANTHRUDNIR ARMS INDUSTRIES</h1>
        <h2>EXTERNAL OPERATIVE FILE</h2>
      </div>

      <div class="divider"></div>

      <!-- PAGE 1: Agreement (hidden until boot finishes) -->
      <section id="page1" class="page">
        <div id="agreement" class="content">
          <div style="font-size:12px;color:var(--muted);margin-bottom:6px">NOTICE & TERMS</div>
          <div>Your participation in the joint training program overseen by <strong>Agent Gungnir</strong> requires strict compliance with corporate confidentiality and safety policies. This ensures the integrity of the upcoming field testing of experimental weaponry and the simulated capture-the-flag exercise.</div>
          <ul>
            <li>All proprietary tech, weapon systems, and data encountered remain classified under VAI IP law.</li>
            <li>No operational details, visuals, or recordings to be disclosed to unauthorized personnel.</li>
            <li>Operatives must comply with on-site safety and directives issued by VAI staff.</li>
            <li>Facility zones and outposts are under continuous surveillance for evaluation and security integrity.</li>
          </ul>

          <div style="height:8px"></div>
          <div style="font-size:12px;color:var(--muted)">DIGITAL SIGNATURE VERIFICATION</div>
          <div class="sig-wrap">
            <input id="signature" type="text" placeholder="Input signature to authorize..." autocomplete="off" />
            <div style="display:flex;gap:8px">
              <button class="btn" id="authBtn">AUTHORIZE & ENTER</button>
              <button class="btn" id="clearBtn">Clear</button>
            </div>
          </div>
        </div>
      </section>

      <!-- PAGE 2: Confirmation -->
      <section id="page2" class="page">
        <div class="ok-badge">[LOG] Signature Accepted</div>
        <div class="log" style="margin-top:6px;padding:8px">[LOG] >>> ACCESS UNLOCKED<br>// Operator Verified<br>// Identity Hash Synced<br>// Clearance Tier Elevated</div>
        <div style="height:8px"></div>
        <div style="font-size:13px;color:#dff9ff">Signature recognized. Identity hash synced to the training database. Your clearance tier has been temporarily elevated for program use.</div>
        <div style="height:10px"></div>
        <div style="display:flex;gap:8px;margin-top:8px">
          <button class="btn" id="openCatalogBtn">Open Catalog</button>
          <button class="btn ghost" id="briefBtn">Quick Briefing</button>
        </div>
      </section>

      <!-- PAGE 3: Catalog index (separate page) -->
      <section id="page3" class="page">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
          <div style="font-weight:700">GUN CATALOG</div>
          <div style="display:flex;gap:6px;align-items:center">
            <button class="btn ghost" id="backTo2">Back</button>
            <div class="small-muted" id="countLabel">0 items</div>
          </div>
        </div>

        <div class="catalog-list" id="catalogList"></div>
        <div style="height:8px"></div>
        <div class="small-muted">Tip: click an item to view full details.</div>
      </section>

      <!-- PAGE 4: Detail (separate page) -->
      <section id="page4" class="page">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div style="font-weight:700" id="detailTitle">—</div>
          <div style="display:flex;gap:6px;align-items:center">
            <button class="btn ghost" id="backTo3">Back</button>
            <div class="small-muted" id="detailIndex">0 / 0</div>
          </div>
        </div>

        <div class="hero" id="detailHero" style="margin-top:8px"></div>
        <div style="height:8px"></div>
        <div class="small-muted" id="detailSub">—</div>
        <div style="height:6px"></div>
        <div style="font-size:13px;color:#dff9ff;max-height:120px;overflow:auto" id="detailDesc">—</div>

        <div class="navs">
          <div style="display:flex;gap:8px">
            <button class="btn" id="prevGun">◀ Prev</button>
            <button class="btn" id="nextGun">Next ▶</button>
          </div>
          <div style="flex:1"></div>
          <div style="display:flex;gap:8px">
            <button class="btn ghost" id="exportDetail">Export CSV</button>
            <button class="btn" id="openExportPage">Export+Print</button>
          </div>
        </div>
      </section>

      <!-- PAGE 5: Export / Print -->
      <section id="page5" class="page">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div style="font-weight:700">EXPORT / PRINT</div>
          <div style="display:flex;gap:8px">
            <button class="btn ghost" id="backFromExport">Back</button>
            <button class="btn" id="printBtn">Print</button>
          </div>
        </div>
        <div style="height:8px"></div>
        <div id="exportContent" class="export-area"></div>
        <div style="height:8px"></div>
        <div class="small-muted">Use Print to create a PDF of the current item.</div>
      </section>

    </div>
  </div>
</div>

<script>
/* ---------- Clock ---------- */
function updateClock(){ const el = document.getElementById('clock'); const d = new Date(); el.textContent = String(d.getHours()).padStart(2,'0') + ':' + String(d.getMinutes()).padStart(2,'0'); }
updateClock(); setInterval(updateClock, 30*1000);

/* ---------- Boot typing ---------- */
const bootLines = [
  "> Initializing Secure Terminal...",
  "> Loading VAI-OS 7.3...",
  "> Establishing encrypted link...",
  "> Performing integrity check...",
  "> Running Authentication Protocol...",
  "> Verifying operative credentials...",
  "> Syncing training manifest...",
  "> Launching operative briefing interface..."
];
const bootLog = document.getElementById('bootLog');
let lineIndex = 0, charIndex = 0;
function typeNextChar(){
  if(lineIndex >= bootLines.length){ clearInterval(typingInterval); setTimeout(()=>{ showPage(1); }, 500); return; }
  const line = bootLines[lineIndex];
  if(!document.getElementById('line-'+lineIndex)){
    const d = document.createElement('div'); d.id = 'line-'+lineIndex; d.textContent = ''; bootLog.appendChild(d);
  }
  const elLine = document.getElementById('line-'+lineIndex);
  if(charIndex < line.length){ elLine.textContent += line.charAt(charIndex); charIndex++; bootLog.scrollTop = bootLog.scrollHeight; }
  else { charIndex = 0; lineIndex++; }
}
const typingInterval = setInterval(typeNextChar, 30);

/* ---------- Gun data (from published doc) ---------- */
const guns = [
  {
    id: "starflare",
    title: "VAIES EP-7 “Starflare”",
    subtitle: "Energy Pistol — Vanthrudnir Arms Industries",
    image: "https://lh7-rt.googleusercontent.com/docsz/AD_4nXcpPpdfEhLbHr-BZPNeV_WRTv3opTFMoko2ha0CXreMHRy9dhDGXnhP2ktvpL6ubZ306yoLnBb1EOlO6jX7W5BJEZh4ynE1AS3dTNrrxNBtIf4PPImxEN2OmrgHyjF7x1-98H2co-mtliJycd4QYt2FCvNy9EA?key=GL6KKFbwoLvnh-YmGZdb6w",
    description: "A compact sidearm powered by an oversized, snap-swap microcell battery. The Starflare fires ionized plasma spikes, compressed bolts of superheated particulate energy that leave thin, glowing trails in the air. Stable, low recoil, and ideal for rapid engagements.\n\nStarflare Operator Instructions:\n1. Power Check: Insert microcell battery until the locking click is heard. Hold trigger half press to confirm charge indicator.\n2. Firing Mode: Single shot only. Weapon regulates spike formation electronically.\n3. Cooling: After 20 consecutive shots, allow 3 seconds idle.\n4. Battery Swap: Press release lever, slide old cell out, insert new one at 15°.\n5. Safety Notes: Do not fire at surfaces adjacent to friendly personnel — plasma backsplash may cause burns."
  },
  {
    id: "kestrel",
    title: "VAIES MP-4 “Kestrel”",
    subtitle: "Magnetic Pistol — Vanthrudnir Arms Industries",
    image: "https://lh7-rt.googleusercontent.com/docsz/AD_4nXdT_NKqBRvt9TmQLvgkiIsCJxLKwPOEGhcnvE0mtxn3wYCC-H4sxjbKoF94Dq4ha4uuA3DxNf2TUWb1kiaEQhOWOa7fFqoEw86yFzXE0L3REBwLBm0-HWasyB0Hz0xj3TKlkXDIKi0u1ly0HUZ2-3Znk5KEEn8?key=GL6KKFbwoLvnh-YmGZdb6w",
    description: "A handheld magnetic accelerator pistol designed for stealth and precision. The Kestrel launches ferro ceramic flechettes using silent coil-pulse sequencing. Minimal muzzle flash, negligible recoil, and perfect for operators who demand clean, trace light impacts.\n\nKestrel Operator Instructions:\n1. Load Magazine: Insert flechette module until the green indicator toggles.\n2. Coil Charge: Weapon pre-charges when gripped; a soft hum indicates priming.\n3. Fire Discipline: Maintain short bursts or single shots to avoid overheating.\n4. Jam Clearing: If a flechette misaligns, rack the slide forward. Do not pull back.\n5. Safety Notes: Avoid placing near magnetic-sensitive equipment."
  },
  {
    id: "thunderline",
    title: "VAIES MS-12 “Thunderline”",
    subtitle: "Magnetic Shotgun — Vanthrudnir Arms Industries",
    image: "https://lh7-rt.googleusercontent.com/docsz/AD_4nXfrKWW-7HndOz0S2E_sfME1PXEU7lko1TLh96ObiTikcNLZWLwIym3urmosE09SAiyHaONsX8xLZ8wtgOpdM0EtKO0YvLg1_4MTvfy4ARK5C-Df79UTQIb4OpcscSAo31JC0D9FqxUgpIFd5Wwtcy0X9lV4zTs?key=GL6KKFbwoLvnh-YmGZdb6w",
    description: "A close quarters magnetic scatter system that fires a spread of fragmenting metal slugs, each accelerated along independent micro coils. The Thunderline delivers dense, high impact kinetic waves capable of shredding armor plating at short range. It hums audibly when charged.\n\nThunderline Operator Instructions:\n1. Load Chamber: Insert slug cartridge pack. MS-12 identifies and calibrates automatically.\n2. Charge Cycle: Hold the fore grip firmly; vibration indicates charging.\n3. Firing: Pull trigger fully for maximum acceleration.\n4. Spread Adjustment: Thumb dial toggles wide/medium/point patterns.\n5. Safety Notes: Do not fire at reinforced walls at close distance — fragment rebounds are dangerous."
  },
  {
    id: "solbreaker",
    title: "VAIES ES-9 “Solbreaker”",
    subtitle: "Energy Shotgun — Vanthrudnir Arms Industries",
    image: "https://lh7-rt.googleusercontent.com/docsz/AD_4nXenEoZizAa6qeND7hnfz-_JBeRWa_wtIhyWEbnXWcoBQc0HRQpPYS7YggCYkjC5H0D9FUIRPRCMx3MeFOQcoZTMDMzrJhLEbGBzrYIzV4sk43hY87HVw_1OW00jeNL0idq2ueoxLxKSZfyWAwAN4g6U_Digaf8?key=GL6KKFbwoLvnh-YmGZdb6w",
    description: "Powered by a large stabilized radial crystal core, sealed in containment plating. The Solbreaker channels volatile crystal energy into burst wave plasma shells, detonating shortly after impact into expanding cones of thermal force. Highly experimental and hazardous to untrained users.\n\nSolbreaker Operator Instructions:\n1. Crystal Verification: Check containment seals for cracks/discoloration; do not activate if present.\n2. Charge Sequence: Pull priming lever to synchronize radial core.\n3. Firing: Expect heavy thermal discharge; maintain full stance.\n4. Cooling: Allow 5–7 seconds between shots.\n5. Safety Notes: Never store near unstable crystal samples; avoid firing in confined environments."
  },
  {
    id: "aetherline",
    title: "VAIES EAR-11 “Aetherline”",
    subtitle: "Magnetic Marksman Rifle — Vanthrudnir Arms Industries",
    image: "https://lh7-rt.googleusercontent.com/docsz/AD_4nXdArrE4niRtlFn05vXk495kpxzteqVR_1A_KoOQuE4aA_DwZ-Wv6NifY1Q_9WBcZFu0c9hePtI8mpTO60FXv299WDzrG9NH4YfCip_bIpl1XsjxJF2IplKGOXr8NHLFh-RsPVITGHDw-0-BL4PL03eNUTLiwo4?key=GL6KKFbwoLvnh-YmGZdb6w",
    description: "A precision magnetic rifle that propels ultra dense metal rods through segmented acceleration chambers. A refined coil pulse system provides consistent velocity and stable penetrator rounds. WARNING: special augments recommended to wield this rifle.\n\nAetherline Operator Instructions:\n1. Load Rods: Insert rod magazine carefully; avoid bare-hand contact due to magnetic sensitivity.\n2. Calibration: Activate coil alignment cycle to self-tune barrel harmonics.\n3. Firing: Exhale, steady aim, squeeze slowly for coil acceleration.\n4. Barrel Cooldown: After 5 shots, allow cooldown.\n5. Safety Notes: Keep the rifle at least 1 meter from strong magnetic emitters or active crystal cores."
  },
  {
    id: "longbite",
    title: "VAIES MMR-6 “Longbite”",
    subtitle: "Energy Assault Rifle — Vanthrudnir Arms Industries",
    image: "https://lh7-rt.googleusercontent.com/docsz/AD_4nXeL8aQLBCA3LGTcJs5aOy4scv-r0-nWES2b_b7w3KtA9k2uaZRk0EshAc3xW6X1xuIv5KdueCbQtcpEae1ZhFQvgLP7IWGltwuRttPyeOlr_v3Y41u6omnD-6VoYfVJ-yM9o7wnLOmkNfmj-ZjlqyetK7y0vIM?key=GL6KKFbwoLvnh-YmGZdb6w",
    description: "Built around a mid-sized stabilized radial crystal array, the Longbite fires consecutive charged energy darts — needle-like high-velocity bolts that partially disintegrate on contact. Select-fire system with exceptional range stability; requires careful crystal management during extended engagements.\n\nLongbite Operator Instructions:\n1. Crystal Initialization: Turn the rear dial until the rifle pings to sync the crystal lattice.\n2. Fire Modes: Toggle Single, Burst, Continuous Pulse via side selector.\n3. Heat Management: Monitor the front heat strip; reduce rate if it turns yellow.\n4. Battery Replace: Detach side panel to swap energy cell; crystal array retains sync for ~3 minutes.\n5. Safety Notes: Avoid firing through particulate smoke or dust clouds."
  }
];

/* UI helpers */
function showPage(n){
  // hide all, show only requested
  for(let i=1;i<=5;i++){
    const p = document.getElementById('page'+i);
    if(p) p.classList.remove('active');
  }
  const target = document.getElementById('page'+n);
  if(target) target.classList.add('active');
  // ensure bootLog scroll remains at bottom as pages change
  bootLog.scrollTop = bootLog.scrollHeight;
}

/* populate catalog (page3) */
function buildCatalog(){
  const c = document.getElementById('catalogList');
  c.innerHTML = '';
  guns.forEach((g,i)=>{
    const node = document.createElement('div');
    node.className = 'gun-item';
    node.dataset.index = i;
    node.innerHTML = `<img src="${g.image}" alt=""><div style="flex:1"><div style="font-weight:700">${g.title}</div><div class="small-muted">${g.subtitle}</div></div>`;
    node.addEventListener('click', ()=> openDetail(i) );
    c.appendChild(node);
  });
  document.getElementById('countLabel').textContent = guns.length + ' items';
}

/* open detail page (page4) */
let currentIndex = 0;
function openDetail(i){
  currentIndex = i;
  const g = guns[i];
  document.getElementById('detailTitle').textContent = g.title;
  document.getElementById('detailSub').textContent = g.subtitle;
  document.getElementById('detailDesc').textContent = g.description;
  document.getElementById('detailIndex').textContent = (i+1) + ' / ' + guns.length;
  const hero = document.getElementById('detailHero');
  hero.innerHTML = '';
  if(g.image){
    const img = document.createElement('img'); img.src = g.image; img.alt = g.title;
    img.onerror = ()=>{ img.style.opacity = 0.35; };
    hero.appendChild(img);
  } else hero.textContent = 'No image';
  showPage(4);
}

/* wiring buttons */
document.getElementById('clearBtn').addEventListener('click', ()=>{ document.getElementById('signature').value=''; document.getElementById('signature').focus(); });
document.getElementById('authBtn').addEventListener('click', ()=>{
  const sig = document.getElementById('signature').value.trim();
  if(sig.length < 2){ document.getElementById('agreement').animate([{ transform: 'translateX(0)' }, { transform:'translateX(-6px)' }, { transform:'translateX(6px)' }, { transform:'translateX(0)'}], { duration:260 }); alert('Please enter a valid signature.'); return; }
  document.getElementById('authBtn').disabled = true;
  document.getElementById('authBtn').textContent = 'VERIFYING...';
  setTimeout(()=>{ document.getElementById('authBtn').textContent = 'AUTHORIZED'; showAccessGranted(); }, 800);
});
function showAccessGranted(){
  // show page2 (confirmation)
  showPage(2);
  const s = document.createElement('div'); s.textContent = '[LOG] Signature accepted • ACCESS UNLOCKED'; s.style.color = '#bafbe6'; bootLog.appendChild(s); bootLog.scrollTop = bootLog.scrollHeight;
}
document.getElementById('openCatalogBtn').addEventListener('click', ()=>{ buildCatalog(); showPage(3); });
document.getElementById('briefBtn').addEventListener('click', ()=>{ alert('Quick Briefing: follow directives and safety protocol.'); });
document.getElementById('backTo2').addEventListener('click', ()=>{ showPage(2); });
document.getElementById('backTo3').addEventListener('click', ()=>{ showPage(3); });
document.getElementById('prevGun').addEventListener('click', ()=>{ currentIndex = (currentIndex-1 + guns.length) % guns.length; openDetail(currentIndex); });
document.getElementById('nextGun').addEventListener('click', ()=>{ currentIndex = (currentIndex+1) % guns.length; openDetail(currentIndex); });

document.getElementById('openExportPage').addEventListener('click', ()=>{
  const g = guns[currentIndex];
  const html = `<div style="font-weight:700">${escapeHtml(g.title)}</div><div style="font-size:13px;color:#6fb7c6">${escapeHtml(g.subtitle)}</div><div style="height:8px"></div><div>${escapeHtml(g.description).replace(/\n/g,'<br>')}</div>`;
  document.getElementById('exportContent').innerHTML = html;
  showPage(5);
});
document.getElementById('backFromExport').addEventListener('click', ()=> showPage(4));
document.getElementById('printBtn').addEventListener('click', ()=> window.print());

/* export current detail as CSV */
document.getElementById('exportDetail').addEventListener('click', ()=>{
  const g = guns[currentIndex];
  const csv = `"id","title","subtitle","image","description"\n"${g.id}","${g.title.replace(/"/g,'""')}","${g.subtitle.replace(/"/g,'""')}","${g.image}","${g.description.replace(/"/g,'""')}"`;
  const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'}); const url = URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download = g.id + '.csv'; a.click(); URL.revokeObjectURL(url);
});

/* keyboard navigation while on detail page */
document.addEventListener('keydown',(e)=>{
  const page4 = document.getElementById('page4');
  if(!page4.classList.contains('active')) return;
  if(e.key === 'ArrowLeft'){ currentIndex = (currentIndex-1 + guns.length) % guns.length; openDetail(currentIndex); }
  if(e.key === 'ArrowRight'){ currentIndex = (currentIndex+1) % guns.length; openDetail(currentIndex); }
});

/* small escapeHtml helper */
function escapeHtml(s){ return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/"/g,'&quot;'); }

/* init: show nothing except boot -> after boot show page1, default */
showPage(0); // temporarily hide all until boot completes
</script>
</body>
</html>
